================================================================================
              ðŸ” PASSWORD RESET - QUICK REFERENCE
================================================================================

BASE URL: http://localhost:3000

================================================================================
                    ðŸ“‹ METHOD 1: FORGOT PASSWORD (PUBLIC)
================================================================================

Use Case: User forgot password, cannot login
Flow: Email â†’ OTP â†’ Verify OTP â†’ Reset Password

STEP 1: REQUEST RESET
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
POST /api/auth/password-reset

Headers:
  X-App-Id: default_app_id
  X-Service-Key: default_service_key
  Content-Type: application/json

Body:
{
  "email": "user@example.com"
}

Response:
{
  "success": true,
  "message": "If the email exists, a password reset code has been sent"
}

STEP 2: VERIFY OTP
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
POST /api/auth/password-reset/verify-otp

Headers:
  Content-Type: application/json

Body:
{
  "email": "user@example.com",
  "otpCode": "123456"
}

Response:
{
  "success": true,
  "message": "OTP verified successfully..."
}

STEP 3: RESET PASSWORD
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
POST /api/auth/password-reset/confirm

Headers:
  Content-Type: application/json

Body:
{
  "email": "user@example.com",
  "otpCode": "123456",
  "newPassword": "NewPassword123!"
}

Response:
{
  "success": true,
  "message": "Password reset successfully. Please login with your new password."
}

================================================================================
              ðŸ“‹ METHOD 2: AUTHENTICATED PASSWORD RESET
================================================================================

Use Case: User is logged in and wants to change password

OPTION A: REQUEST RESET EMAIL (WITH LINK)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
POST /api/my-profile/request-password-reset

Headers:
  Authorization: Bearer YOUR_JWT_TOKEN

No Body Required

Response:
{
  "success": true,
  "message": "Password reset email sent successfully",
  "data": {
    "email": "user@example.com"
  }
}

User receives email with link:
http://localhost:3001/reset-password?token=...

OPTION B: CHANGE PASSWORD (WITH OLD PASSWORD)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
POST /api/my-profile/change-password

Headers:
  Authorization: Bearer YOUR_JWT_TOKEN
  Content-Type: application/json

Body:
{
  "oldPassword": "CurrentPassword123!",
  "newPassword": "NewPassword456!"
}

Response:
{
  "success": true,
  "message": "Password changed successfully"
}

================================================================================
                         ðŸ“Š COMPARISON TABLE
================================================================================

Feature                  | Public Reset      | Authenticated Reset
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Login Required           | âŒ No            | âœ… Yes (JWT)
Requires Email           | âœ… Yes           | âŒ No (from token)
Requires OTP             | âœ… Yes (6 digits)| âŒ No
Requires Old Password    | âŒ No            | âœ… Yes (Option B)
Steps                    | 3 steps          | 1 step
Sessions Invalidated     | âœ… Yes (all)     | âŒ No (remains logged in)
Use Case                 | Forgot password  | Change password

================================================================================
                         ðŸ’» JAVASCRIPT EXAMPLES
================================================================================

// PUBLIC RESET - STEP 1: Request Reset
await fetch('http://localhost:3000/api/auth/password-reset', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'X-App-Id': 'default_app_id',
    'X-Service-Key': 'default_service_key'
  },
  body: JSON.stringify({ email: 'user@example.com' })
}).then(r => r.json())

// PUBLIC RESET - STEP 2: Verify OTP
await fetch('http://localhost:3000/api/auth/password-reset/verify-otp', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    email: 'user@example.com',
    otpCode: '123456'
  })
}).then(r => r.json())

// PUBLIC RESET - STEP 3: Reset Password
await fetch('http://localhost:3000/api/auth/password-reset/confirm', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    email: 'user@example.com',
    otpCode: '123456',
    newPassword: 'NewPassword123!'
  })
}).then(r => r.json())

// AUTHENTICATED - Change Password
const token = localStorage.getItem('authToken')

await fetch('http://localhost:3000/api/my-profile/change-password', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${token}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    oldPassword: 'CurrentPassword123!',
    newPassword: 'NewPassword456!'
  })
}).then(r => r.json())

================================================================================
                         ðŸ”‘ KEY POINTS
================================================================================

PUBLIC RESET:
  âœ… No login required
  âœ… Uses email + OTP verification
  âœ… OTP expires in 10 minutes
  âœ… All user sessions invalidated after reset
  âœ… User must login again with new password

AUTHENTICATED RESET:
  âœ… Login required (JWT token)
  âœ… Option A: Email with reset link
  âœ… Option B: Change with old password
  âœ… User remains logged in (Option B)
  âœ… Instant password change

================================================================================
                         ðŸ“§ EMAIL DETAILS
================================================================================

OTP Email (Public Reset):
  From: smartvisitor.cbiz365@gmail.com
  Subject: Password Reset Code
  Content: 6-digit OTP code
  Expires: 10 minutes

Reset Link Email (Authenticated):
  From: smartvisitor.cbiz365@gmail.com
  Subject: Password Reset Request
  Content: Clickable reset link
  Link: http://localhost:3001/reset-password?token=...
  Expires: 1 hour

================================================================================
                         âœ… ALL OPTIONS AVAILABLE
================================================================================

âœ… Public Password Reset (Forgot Password)
   - 3-step OTP process
   - No login required
   - Email verification

âœ… Authenticated Password Reset
   - Option A: Email with link
   - Option B: Change with old password
   - Login required

âœ… All working with Gmail SMTP
âœ… Can send to any email address
âœ… Production ready

================================================================================


